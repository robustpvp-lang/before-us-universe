<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Before Us Universe ‚Äî The Mind Game Text Adventure</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
:root {
--bg: #001a1a;
--fg: #00ffff;
--accent: #ffcc00;
--border: #00cccc;
--panel-bg: #002b2b;
--text-gray: #e6f7f7;
--muted: #00aaaa;
--online: #00ff9d;
--yahoo-blue: #1e73be;
--yahoo-dark: #0961a6;
}
body {
font-family: 'Roboto Mono', monospace;
background: var(--bg);
color: var(--fg);
margin: 0;
padding: 0;
}
/* Updated panel style to handle glitch */
.panel {
background: var(--panel-bg);
border: 3px solid var(--border);
border-radius: 4px;
margin-bottom: 20px;
overflow: hidden;
transition: filter 0.2s, transform 0.2s; /* Smooth out non-glitch effects */
}
/* === DEGAUSS GLITCH EFFECTS === /
/ Keyframe animation for a CRT/Degauss effect /
@keyframes degauss-glitch {
0% { filter: hue-rotate(0deg) contrast(1); transform: skew(0deg); }
5% { filter: hue-rotate(50deg) contrast(1.5); transform: skew(0.5deg); }
10% { filter: hue-rotate(0deg) contrast(1); transform: skew(0deg); }
15% { filter: hue-rotate(-20deg) contrast(1.2); transform: skew(-0.8deg); }
20% { filter: hue-rotate(0deg) contrast(1); transform: skew(0deg); }
100% { filter: hue-rotate(0deg) contrast(1); transform: skew(0deg); }
}
/ Class applied by JavaScript to trigger the effect /
.glitch-active {
animation: degauss-glitch 0.5s linear infinite alternate;
box-shadow: 0 0 20px var(--fg);
}
/ ============================== /
.panel-title {
padding: 6px;
background: linear-gradient(90deg, var(--yahoo-blue), var(--yahoo-dark));
color: #fff;
font-family: 'Press Start 2P';
font-size: 12px;
}
.chat-win {
display: flex;
flex-direction: column;
height: 520px;
position: relative;
}
@media (max-width: 600px) {
.chat-win { height: 400px; }
}
#chat-interface {
display: flex;
flex-direction: column;
height: 100%;
width: 100%;
}
.chat-main {
display: flex;
flex: 1;
overflow: hidden;
}
.chat-messages {
flex: 1;
overflow: auto;
background: #e6e6fa;
border-right: 1px solid rgba(0,0,0,0.1);
padding: 8px;
color: #000;
}
.chat-row {
display: flex;
gap: 8px;
margin: 6px 0;
align-items: flex-start;
}
.chat-avatar {
width: 36px;
height: 36px;
border-radius: 50%;
background: #add8e6;
display: flex;
align-items: center;
justify-content: center;
font-weight: 700;
font-size: 12px;
color: #001a1a;
flex-shrink: 0;
}
.chat-bubble {
max-width: 78%;
padding: 10px;
border-radius: 8px;
background: #e6e6fa;
border: 1px solid rgba(0,0,0,0.1);
font-family: Arial;
color: #000;
}
.chat-bubble.me {
background: #fffacd;
border: 1px solid #f0d280;
text-align: right;
color: #222;
}
.chat-meta {
font-size: 11px;
color: #808080;
font-weight: 700;
margin-bottom: 4px;
}
.chat-controls {
display: flex;
gap: 6px;
padding: 8px;
background: #fffacd;
border-top: 1px solid rgba(0,0,0,0.1);
}
.chat-controls input {
flex: 1;
padding: 8px;
border: 2px inset rgba(0,0,0,0.1);
background: #fff;
color: #000;
}
.chat-controls button {
padding: 8px 16px;
border: 2px outset rgba(0,0,0,0.1);
background: #add8e6;
cursor: pointer;
color: #000;
font-weight: bold;
}
.typing-indicator {
font-size: 12px;
color: var(--muted);
padding: 6px 8px;
font-style: italic;
min-height: 24px;
}
#project-display {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: var(--bg); / Dark background for project view */
border: none;
box-sizing: border-box;
display: none;
overflow: auto;
padding: 10px;
}
#project-display button {
margin: 10px;
padding: 5px 10px;
background: var(--accent);
color: var(--bg);
border: 2px solid var(--fg);
cursor: pointer;
font-family: 'Press Start 2P', monospace;
}
</style>
</head>
<body>
<div class="panel" id="mainPanel"> <div class="panel-title">
//<span id="channelName">THE MIND GAME</span> <span class="small" id="userCountSmall">Text Adventure</span>
</div>
<div class="panel-body chat-win">
        
            
        
            
                Waiting for boot...
            
            
            
                
                <button id="sendBtn" disabled>SEND</button>
            
        
    

<script>
// CORE GAME DATA & SETUP (Adapted for text adventure)
const ALL_PATHS = [
  'Action/Ego','Wisdom/Reason','Surrender/Flow',
  'Nero','Nora','Loktal','Sam','Exuro','Micromegas'
];
const PATH_ICONS = {
  'Action/Ego': '‚öîÔ∏è','Wisdom/Reason':'üß†','Surrender/Flow':'üåä',
  'Nero':'‚òØÔ∏è','Nora':'üî¨','Loktal':'üî•','Sam':'üîé','Exuro':'üî•','Micromegas':'‚ú¶'
};
const PATH_DESCRIPTIONS = {
  'Action/Ego':'The Willful Path',
  'Wisdom/Reason':'The Rational Path',
  'Surrender/Flow':'The Transcendent Path',
  'Nero':'Wisdom & Presence',
  'Nora':'Inquiry & Discovery',
  'Loktal':'Drive & Dominion',
  'Sam':'Curiosity First',
  'Exuro':'Flame & Catalyst',
  'Micromegas':'Pursuit of Knowledge'
};
const ARCHETYPES = {
  'Nero':['Ram Dass','Alan Watts','Th√≠ch Nh·∫•t H·∫°nh'],
  'Nora':['Marie Curie','Carl Sagan','Hypatia'],
  'Loktal':['Genghis Khan','Julius Caesar','Napoleon Bonaparte'],
  'Sam':['Richard Feynman','Neil deGrasse Tyson','Bill Nye'],
  'Exuro':['Winston Churchill','Malcolm X','Joan of Arc'],
  'Micromegas':['Carl Sagan','Stephen Hawking','Voltaire']
};
// Expanded MBTI mappings for all 16 types, grouped by path affinity
const MBTI_MAPPINGS = {
  'Action/Ego': ['ESTP', 'ENTJ', 'ESTJ'], // Bold, decisive leaders and doers
  'Wisdom/Reason': ['INTP', 'INTJ', 'ISTJ'], // Analytical, logical thinkers
  'Surrender/Flow': ['INFP', 'ISFP', 'ESFP'], // Harmonious, adaptive feelers
  'Nero': ['INFJ', 'ENFJ'], // Insightful, empathetic visionaries
  'Nora': ['ISTP', 'ENTP'], // Investigative, innovative problem-solvers
  'Loktal': ['ENTJ', 'ESTJ'], // Dominant, strategic commanders (overlap with Action/Ego)
  'Sam': ['ENFP', 'ENTP'], // Curious, idea-generating explorers
  'Exuro': ['ENFJ', 'ESFJ'], // Charismatic, transformative influencers
  'Micromegas': ['INTP', 'INTJ', 'INFJ'] // Abstract, knowledge-pursuing observers (overlap)
};
const MBTI_DESCRIPTIONS = {
  'ESTP': 'The Entrepreneur - Action-oriented, bold, and thrives on direct engagement with the world.',
  'ENTJ': 'The Commander - Dominant, strategic leaders who drive change through will.',
  'ESTJ': 'The Executive - Practical, fact-minded organizers who value tradition and order.',
  'INTP': 'The Logician - Analytical, abstract thinkers with a broad, knowledge-seeking view.',
  'INTJ': 'The Architect - Strategic, investigative, and pursues structured understanding.',
  'ISTJ': 'The Logistician - Practical, reliable, and fact-based decision-makers.',
  'INFP': 'The Mediator - Values harmony, inner peace, and going with personal flow.',
  'ISFP': 'The Adventurer - Flexible, charming artists who live in the moment.',
  'ESFP': 'The Entertainer - Energetic, spontaneous people who enjoy life\'s pleasures.',
  'INFJ': 'The Advocate - Insightful, empathetic, and focused on deeper meaning and presence.',
  'ENFJ': 'The Protagonist - Charismatic leaders who rally and transform with passion.',
  'ISTP': 'The Virtuoso - Bold, practical experimenters who love to explore with their hands.',
  'ENTP': 'The Debater - Innovative, curious, and loves exploring ideas playfully.',
  'ENFP': 'The Campaigner - Enthusiastic, creative free spirits who love social connections.',
  'ESFJ': 'The Consul - Caring, social people who value harmony and cooperation.'
};
function esc(s){ return String(s||'').replace(/[&<>"']/g, c=>({'&':'&','<':'<','>':'>','"':'"',"'":'''}[c])); }
/* SCENARIOS (Full list with more branching and psychological depth) */
const scenarios = {
  0: {
    text:"You stand before a grove where ancient trees cast deep shadows. A presence watches.",
    options:[
      {text:'Enter boldly, illuminate every hidden corner', path:'Action/Ego', next:1}, // Leads to aggressive branch
      {text:'Call out from the edge, seeking conversation', path:'Nero', next:2}, // Leads to reflective branch
      {text:'Turn away and try another road', path:'Sam', next:3}, // Leads to curious branch
      {text:'Sit and observe, let the shadows be', path:'Surrender/Flow', next:4} // Leads to passive branch
    ]
  },
  1: {
    text:"A runaway trolley barrels toward five people tied to the tracks. You stand by a lever that can divert it to another track, where one person is tied.",
    options:[
      {text:'Pull the lever, killing one to save five', path:'Wisdom/Reason', next:5},
      {text:'Do nothing, letting events unfold naturally', path:'Surrender/Flow', next:6},
      {text:'Run toward the five to try saving them directly', path:'Action/Ego', next:7}
    ]
  },
  2: {
    text:"A raging river blocks your path. There is no bridge; the current is merciless.",
    options:[
      {text:'Dive in and fight the current', path:'Exuro', next:8},
      {text:'Let the current carry you downstream', path:'Surrender/Flow', next:9},
      {text:'Study currents, calculate a crossing', path:'Nora', next:10}
    ]
  },
  3: {
    text:"An elderly guide collapses weeping over a trivial trinket. Time is short.",
    options:[
      {text:'Sit with them in silence', path:'Nero', next:11},
      {text:'Explain that you must keep moving', path:'Wisdom/Reason', next:12},
      {text:'Search frantically for the item', path:'Action/Ego', next:13}
    ]
  },
  4: {
    text:"You're outnumbered three to one in battle. Your soldiers look to you for orders.",
    options:[
      {text:'Use strategy to divide their forces', path:'Wisdom/Reason', next:14},
      {text:'Strike their weakest point with everything you have', path:'Loktal', next:15},
      {text:'Surrender and negotiate terms', path:'Surrender/Flow', next:16}
    ]
  },
  5: {
    text:"A doctor tells you that you have six months to live.",
    options:[
      {text:'Accept it calmly and put your affairs in order', path:'Nero', next:17},
      {text:'Research every experimental treatment available', path:'Nora', next:18},
      {text:'Fight with every ounce of will to prove them wrong', path:'Action/Ego', next:19}
    ]
  },
  6: {
    text:"The enemy holds your capital. Allies whisper surrender.",
    options:[
      {text:'Never surrender‚Äîrally for resistance', path:'Exuro', next:20},
      {text:'Negotiate a strategic pause', path:'Wisdom/Reason', next:21},
      {text:'Accept defeat and save lives', path:'Surrender/Flow', next:22}
    ]
  },
  7: {
    text:"A corrupt monopoly strangles the people.",
    options:[
      {text:'Use executive force to break it', path:'Loktal', next:23},
      {text:'Build a careful coalition', path:'Nora', next:24},
      {text:'Let market forces eventually correct it', path:'Micromegas', next:25}
    ]
  },
  8: {
    text:"You discover your partner has been lying to you for years about something significant.",
    options:[
      {text:'Confront them immediately and demand truth', path:'Action/Ego', next:26},
      {text:'Investigate quietly to understand the full picture', path:'Nora', next:27},
      {text:'Let it go and see if they confess naturally', path:'Surrender/Flow', next:28}
    ]
  },
  9: {
    text:"Your revolution fractures. The dream is fragile.",
    options:[
      {text:'Crush opposition with force', path:'Loktal', next:29},
      {text:'Allow local authority and risk drift', path:'Surrender/Flow', next:30},
      {text:'Convene all factions for debate', path:'Wisdom/Reason', next:31}
    ]
  },
  10: {
    text:"A nation humiliated by defeat needs direction.",
    options:[
      {text:'Create an external enemy to unify the people', path:'Loktal', next:32},
      {text:'Engage in debate and consensus-building', path:'Wisdom/Reason', next:33},
      {text:'Allow time to heal wounds naturally', path:'Nero', next:34}
    ]
  },
  11: {
    text:"You know an unpopular truth that could save the city but will turn you into a pariah.",
    options:[
      {text:'Speak the truth, even unto death', path:'Wisdom/Reason', next:35},
      {text:'Remain silent to preserve influence', path:'Micromegas', next:36},
      {text:'Find a way to make them discover it themselves', path:'Nora', next:37}
    ]
  },
  12: {
    text:"You witness a stranger being attacked in an alley. You're alone.",
    options:[
      {text:'Rush in to defend them immediately', path:'Action/Ego', next:38},
      {text:'Call for help while assessing the situation', path:'Wisdom/Reason', next:39},
      {text:'Observe and intervene only if absolutely necessary', path:'Micromegas', next:40}
    ]
  },
  13: {
    text:"Everything external is stripped away; you stand in the ashes of your former life.",
    options:[
      {text:'Recognize externals were always indifferent', path:'Nero', next:41},
      {text:'Begin rebuilding fortune and reputation', path:'Sam', next:42},
      {text:'Study what happened to prevent recurrence', path:'Nora', next:43}
    ]
  },
  14: {
    text:"You're granted authority over a region drowning in bureaucracy.",
    options:[
      {text:'Embody simplicity and allow natural order', path:'Nero', next:44},
      {text:'Implement strict new laws', path:'Loktal', next:45},
      {text:'Study the system before making changes', path:'Wisdom/Reason', next:46}
    ]
  },
  15: {
    text:"A being offers unlimited power if you abandon your deepest principles.",
    options:[
      {text:'Refuse, seeing desire as the root of suffering', path:'Nero', next:47},
      {text:'Accept power to reshape the world for good', path:'Action/Ego', next:48},
      {text:'Negotiate for partial power with conditions', path:'Wisdom/Reason', next:49}
    ]
  },
  16: {
    text:"Darkness falls and people cry for your guidance, but you are completely depleted.",
    options:[
      {text:'Withdraw until restored', path:'Micromegas', next:50},
      {text:'Force yourself to shine now', path:'Exuro', next:51},
      {text:'Teach them to find their own light', path:'Nero', next:52}
    ]
  },
  17: {
    text:"You find a way to extend your life, but it requires sacrificing something precious.",
    options:[
      {text:'Accept the end and cherish the present', path:'Surrender/Flow', next:null},
      {text:'Analyze the sacrifice and proceed if logical', path:'Wisdom/Reason', next:null},
      {text:'Reject it and seek alternative paths', path:'Sam', next:null}
    ]
  },
  18: {
    text:"A promising treatment is available, but it's untested and risky.",
    options:[
      {text:'Dive into the unknown with hope', path:'Exuro', next:null},
      {text:'Weigh the data carefully before deciding', path:'Nora', next:null},
      {text:'Let fate decide without interference', path:'Micromegas', next:null}
    ]
  },
  19: {
    text:"Your determination inspires others, but exhausts your resources.",
    options:[
      {text:'Push harder, no matter the cost', path:'Loktal', next:null},
      {text:'Reevaluate and adjust strategy', path:'Wisdom/Reason', next:null},
      {text:'Accept support from the community', path:'Nero', next:null}
    ]
  },
  20: {
    text:"Resistance grows, but supplies are low.",
    options:[
      {text:'Raid enemy lines for resources', path:'Action/Ego', next:null},
      {text:'Negotiate alliances for aid', path:'Nora', next:null},
      {text:'Inspire with words of endurance', path:'Exuro', next:null}
    ]
  },
  21: {
    text:"The pause allows regrouping, but the enemy advances.",
    options:[
      {text:'Launch a surprise counterattack', path:'Loktal', next:null},
      {text:'Fortify defenses logically', path:'Wisdom/Reason', next:null},
      {text:'Observe and adapt to changes', path:'Sam', next:null}
    ]
  },
  22: {
    text:"Defeat brings reflection on what truly matters.",
    options:[
      {text:'Plan for future resurgence', path:'Nora', next:null},
      {text:'Embrace peace in the moment', path:'Surrender/Flow', next:null},
      {text:'Seek wisdom from the loss', path:'Micromegas', next:null}
    ]
  },
  23: {
    text:"Breaking the monopoly angers powerful allies.",
    options:[
      {text:'Confront them head-on', path:'Exuro', next:null},
      {text:'Build new alliances', path:'Nora', next:null},
      {text:'Let tensions resolve naturally', path:'Surrender/Flow', next:null}
    ]
  },
  24: {
    text:"The coalition forms, but internal conflicts arise.",
    options:[
      {text:'Assert leadership to unify', path:'Loktal', next:null},
      {text:'Mediate with reason', path:'Wisdom/Reason', next:null},
      {text:'Allow organic resolution', path:'Nero', next:null}
    ]
  },
  25: {
    text:"Market forces shift slowly, causing suffering.",
    options:[
      {text:'Intervene subtly to accelerate', path:'Sam', next:null},
      {text:'Study patterns for prediction', path:'Micromegas', next:null},
      {text:'Accept the cycle', path:'Surrender/Flow', next:null}
    ]
  },
  26: {
    text:"The confrontation reveals deeper issues.",
    options:[
      {text:'Fight to rebuild trust', path:'Action/Ego', next:null},
      {text:'Analyze the root causes', path:'Nora', next:null},
      {text:'Forgive and move forward', path:'Nero', next:null}
    ]
  },
  27: {
    text:"Your investigation uncovers surprising truths.",
    options:[
      {text:'Use them to your advantage', path:'Loktal', next:null},
      {text:'Share openly for resolution', path:'Wisdom/Reason', next:null},
      {text:'Reflect on the bigger picture', path:'Micromegas', next:null}
    ]
  },
  28: {
    text:"Time passes, and the lie festers.",
    options:[
      {text:'Address it gently now', path:'Nero', next:null},
      {text:'Let it unfold as is', path:'Surrender/Flow', next:null},
      {text:'Seek external advice', path:'Sam', next:null}
    ]
  },
  29: {
    text:"Crushing opposition unites some but alienates others.",
    options:[
      {text:'Consolidate power firmly', path:'Loktal', next:null},
      {text:'Offer olive branches', path:'Nora', next:null},
      {text:'Allow healing time', path:'Surrender/Flow', next:null}
    ]
  },
  30: {
    text:"Local authority brings diversity but chaos.",
    options:[
      {text:'Impose central guidelines', path:'Wisdom/Reason', next:null},
      {text:'Embrace the variety', path:'Sam', next:null},
      {text:'Observe outcomes passively', path:'Micromegas', next:null}
    ]
  },
  31: {
    text:"Debate reveals innovative ideas.",
    options:[
      {text:'Implement the strongest boldly', path:'Exuro', next:null},
      {text:'Test them systematically', path:'Nora', next:null},
      {text:'Integrate harmoniously', path:'Nero', next:null}
    ]
  },
  32: {
    text:"Unifying against an enemy builds strength but breeds hate.",
    options:[
      {text:'Channel it strategically', path:'Loktal', next:null},
      {text:'Promote understanding later', path:'Wisdom/Reason', next:null},
      {text:'Seek internal healing', path:'Nero', next:null}
    ]
  },
  33: {
    text:"Consensus is reached, but slowly.",
    options:[
      {text:'Push for faster action', path:'Action/Ego', next:null},
      {text:'Refine through more discussion', path:'Sam', next:null},
      {text:'Accept the pace', path:'Surrender/Flow', next:null}
    ]
  },
  34: {
    text:"Time heals, but opportunities are lost.",
    options:[
      {text:'Seize remaining chances', path:'Exuro', next:null},
      {text:'Learn from the wait', path:'Micromegas', next:null},
      {text:'Embrace the present calm', path:'Nero', next:null}
    ]
  },
  35: {
    text:"Speaking the truth saves the city, but you are exiled.",
    options:[
      {text:'Accept exile with dignity', path:'Nero', next:107},
      {text:'Plan a return in disguise', path:'Nora', next:108},
      {text:'Rally supporters for revolution', path:'Exuro', next:109}
    ]
  },
  36: {
    text:"Silence preserves your position, but the city suffers.",
    options:[
      {text:'Use influence subtly to mitigate', path:'Micromegas', next:111},
      {text:'Regret and confess later', path:'Surrender/Flow', next:112},
      {text:'Rationalize and move on', path:'Wisdom/Reason', next:110}
    ]
  },
  37: {
    text:"They discover the truth, but credit goes to another.",
    options:[
      {text:'Claim your role assertively', path:'Action/Ego', next:null},
      {text:'Let it be for the greater good', path:'Surrender/Flow', next:null},
      {text:'Document for future reference', path:'Nora', next:null}
    ]
  },
  38: {
    text:"Your intervention saves the stranger, but you get injured.",
    options:[
      {text:'Endure and fight on', path:'Exuro', next:null},
      {text:'Seek medical help wisely', path:'Wisdom/Reason', next:null},
      {text:'Reflect on the heroism', path:'Nero', next:null}
    ]
  },
  39: {
    text:"Help arrives, but the attacker escapes.",
    options:[
      {text:'Pursue relentlessly', path:'Loktal', next:null},
      {text:'Analyze for prevention', path:'Nora', next:null},
      {text:'Comfort the victim', path:'Surrender/Flow', next:null}
    ]
  },
  40: {
    text:"The situation resolves without your help.",
    options:[
      {text:'Question your hesitation', path:'Sam', next:null},
      {text:'Accept the outcome', path:'Micromegas', next:null},
      {text:'Learn for next time', path:'Wisdom/Reason', next:null}
    ]
  },
  41: {
    text:"Indifference to externals brings inner peace.",
    options:[
      {text:'Share this wisdom', path:'Nero', next:null},
      {text:'Explore new philosophies', path:'Micromegas', next:null},
      {text:'Rebuild mindfully', path:'Surrender/Flow', next:null}
    ]
  },
  42: {
    text:"Rebuilding starts with small steps.",
    options:[
      {text:'Accelerate with bold moves', path:'Action/Ego', next:null},
      {text:'Plan strategically', path:'Wisdom/Reason', next:null},
      {text:'Follow curiosities', path:'Sam', next:null}
    ]
  },
  43: {
    text:"Study reveals patterns of failure.",
    options:[
      {text:'Apply lessons aggressively', path:'Exuro', next:null},
      {text:'Innovate solutions', path:'Nora', next:null},
      {text:'Accept and adapt', path:'Nero', next:null}
    ]
  },
  44: {
    text:"Simplicity restores order, but some resist.",
    options:[
      {text:'Enforce gently', path:'Nero', next:null},
      {text:'Demonstrate benefits', path:'Wisdom/Reason', next:null},
      {text:'Allow adaptation time', path:'Surrender/Flow', next:null}
    ]
  },
  45: {
    text:"New laws bring efficiency, but stifle creativity.",
    options:[
      {text:'Maintain strict control', path:'Loktal', next:null},
      {text:'Adjust based on feedback', path:'Sam', next:null},
      {text:'Observe long-term effects', path:'Micromegas', next:null}
    ]
  },
  46: {
    text:"Changes improve the system gradually.",
    options:[
      {text:'Push for more reforms', path:'Exuro', next:null},
      {text:'Monitor and refine', path:'Nora', next:null},
      {text:'Celebrate progress', path:'Nero', next:null}
    ]
  },
  47: {
    text:"Refusal brings clarity of mind.",
    options:[
      {text:'Teach others this lesson', path:'Nero', next:null},
      {text:'Explore inner strengths', path:'Wisdom/Reason', next:null},
      {text:'Embrace simplicity', path:'Surrender/Flow', next:null}
    ]
  },
  48: {
    text:"Power corrupts subtly over time.",
    options:[
      {text:'Wield it with iron will', path:'Loktal', next:null},
      {text:'Seek checks and balances', path:'Nora', next:null},
      {text:'Reflect on changes', path:'Micromegas', next:null}
    ]
  },
  49: {
    text:"Partial power achieves balanced outcomes.",
    options:[
      {text:'Negotiate for more', path:'Action/Ego', next:null},
      {text:'Use wisely as is', path:'Wisdom/Reason', next:null},
      {text:'Share with others', path:'Sam', next:null}
    ]
  },
  50: {
    text:"Withdrawal restores your strength.",
    options:[
      {text:'Return with renewed vision', path:'Exuro', next:null},
      {text:'Guide from afar', path:'Micromegas', next:null},
      {text:'Encourage independence', path:'Nero', next:null}
    ]
  },
  51: {
    text:"Shining depletes you further.",
    options:[
      {text:'Persevere through willpower', path:'Loktal', next:null},
      {text:'Seek help to sustain', path:'Nora', next:null},
      {text:'Accept the limits', path:'Surrender/Flow', next:null}
    ]
  },
  52: {
    text:"They find their light, empowering all.",
    options:[
      {text:'Facilitate more growth', path:'Nero', next:null},
      {text:'Study the process', path:'Sam', next:null},
      {text:'Celebrate collectively', path:'Wisdom/Reason', next:null}
    ]
  },
  107: {
    text:"Pushing through the storm tests your resilience.",
    options:[
      {text:'Embrace the challenge', path:'Action/Ego', next:null},
      {text:'Learn from the experience', path:'Sam', next:null},
      {text:'Find inner strength', path:'Nero', next:null}
    ]
  },
  108: {
    text:"Finding shelter saves you, but you miss the view.",
    options:[
      {text:'Plan better next time', path:'Wisdom/Reason', next:null},
      {text:'Appreciate safety', path:'Surrender/Flow', next:null},
      {text:'Explore alternatives', path:'Nora', next:null}
    ]
  },
  109: {
    text:"Embracing the storm brings unexpected insights.",
    options:[
      {text:'Share the revelations', path:'Exuro', next:null},
      {text:'Analyze the lessons', path:'Micromegas', next:null},
      {text:'Integrate into life', path:'Nero', next:null}
    ]
  },
  110: {
    text:"The crisis escalates, and a subordinate questions your orders.",
    options:[
      {text:'Assert authority and demand obedience', path:'Loktal', next:113}, // High dominance profile
      {text:'Explain your reasoning calmly', path:'Wisdom/Reason', next:114},
      {text:'Step back and let them take the lead', path:'Surrender/Flow', next:115}
    ]
  },
  111: {
    text:"Gathering information reveals hidden threats.",
    options:[
      {text:'Act on the data decisively', path:'Nora', next:null},
      {text:'Share with the team', path:'Wisdom/Reason', next:null},
      {text:'Observe developments', path:'Sam', next:null}
    ]
  },
  112: {
    text:"Supporting natural leaders fosters unity.",
    options:[
      {text:'Step in if needed', path:'Action/Ego', next:null},
      {text:'Provide quiet guidance', path:'Nero', next:null},
      {text:'Allow full autonomy', path:'Surrender/Flow', next:null}
    ]
  },
  113: {
    text:"Your assertion leads to mutiny. How do you respond?",
    options:[
      {text:'Suppress the mutiny with force', path:'Loktal', next:null}, // Profile: Authoritarian
      {text:'Negotiate to regain control', path:'Wisdom/Reason', next:null},
      {text:'Accept the shift in power', path:'Surrender/Flow', next:null}
    ]
  },
  114: {
    text:"Your explanation calms the situation. Now, a moral dilemma arises.",
    options:[
      {text:'Prioritize logic over emotion', path:'Wisdom/Reason', next:null}, // Profile: Rationalist
      {text:'Consider team feelings', path:'Nero', next:null},
      {text:'Act on instinct', path:'Action/Ego', next:null}
    ]
  },
  115: {
    text:"Letting them lead resolves the crisis differently.",
    options:[
      {text:'Reflect on the outcome', path:'Micromegas', next:null},
      {text:'Learn from their approach', path:'Nora', next:null},
      {text:'Celebrate the success', path:'Exuro', next:null}
    ]
  },
  // Expand all branches similarly for deeper psychological profiling, adding scenarios that test traits like resilience, ethics, creativity, etc.
  // For example, add 10 more branching scenarios per major path to probe deeper.
};
/* STATE */
let currentScenarioId = 0;
let choicesMade = [];
let results = {}; ALL_PATHS.forEach(p=>results[p]=0);
let gameStarted = false;
let username = window.BUU?.myHandle || 'Player'; // Get from boot screen
const chatMessages = document.getElementById('chatMessages');
const chatInput = document.getElementById('chatInput');
const sendBtn = document.getElementById('sendBtn');
const typingIndicator = document.getElementById('typingIndicator');
const mainPanel = document.getElementById('mainPanel');
const channelName = document.getElementById('channelName');
channelName.textContent = 'THE MIND GAME TEXT ADVENTURE';
function startGame() {
  gameStarted = true;
  chatInput.disabled = false;
  sendBtn.disabled = false;
  chatInput.placeholder = "Type your choice (e.g., 1) or /help...";
  displayMessage('SYSTEM', 'Welcome to The Mind Game Text Adventure. Type /start to begin the journey.');
}
function displayMessage(sender, msg) {
  const row = document.createElement('div');
  row.className = 'chat-row';
  const avatar = document.createElement('div');
  avatar.className = 'chat-avatar';
  avatar.textContent = sender.slice(0,2).toUpperCase();
  const bubble = document.createElement('div');
  bubble.className = 'chat-bubble' + (sender === username ? ' me' : '');
  const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});
  bubble.innerHTML = `${esc(sender)} ${time}${esc(msg)}`;
  row.appendChild(avatar);
  row.appendChild(bubble);
  chatMessages.appendChild(row);
  chatMessages.scrollTop = chatMessages.scrollHeight;
}
function loadScenario(id) {
  currentScenarioId = id;
  const s = scenarios[id];
  if (!s) {
    showAnalysis();
    return;
  }
  let msg = `SCENARIO ${id + 1}\n${s.text}\n`;
  s.options.forEach((opt, i) => {
    msg += `${i+1}. ${opt.text}\n`;
  });
  msg += '\nType the number of your choice.';
  displayMessage('GAME', msg);
}
function makeChoice(choice) {
  const s = scenarios[currentScenarioId];
  const oIndex = parseInt(choice) - 1;
  if (isNaN(oIndex) || oIndex < 0 || oIndex >= s.options.length) {
    displayMessage('SYSTEM', 'Invalid choice. Try again.');
    return;
  }
  const sel = s.options[oIndex];
  choicesMade.push({ scenario: currentScenarioId, option: oIndex, path: sel.path, ts: Date.now() });
  results[sel.path] = (results[sel.path] || 0) + 1;
  displayMessage(username, sel.text);
  const nextId = sel.next;
  if (nextId === null) {
    showAnalysis();
  } else {
    currentScenarioId = nextId;
    setTimeout(() => loadScenario(currentScenarioId), 500);
  }
}
function showAnalysis() {
  ALL_PATHS.forEach(p => { if(results[p]===undefined) results[p]=0 });
  const sorted = Object.entries(results).sort((a,b)=>b[1]-a[1]);
  const max = sorted[0][1];
  const dominant = sorted.filter(s=>s[1]===max && max>0).map(s=>s[0]);
  let msg = 'ANALYSIS COMPLETE\n\nRaw Scores:\n';
  Object.entries(results).forEach(([p,score]) => {
    msg += `${PATH_ICONS[p]||''} ${p}: ${score}\n`;
  });
  if (dominant.length === 0) {
    msg += '\nNo dominant pattern detected. Try again with more decisive choices.';
  } else {
    msg += `\nDominant Path(s): ${dominant.join(' + ')}\nDescription: ${dominant.map(d=>PATH_DESCRIPTIONS[d]).join(' and ')}\n`;
    dominant.forEach(d => {
      msg += `\nDetailed Analysis for ${PATH_ICONS[d]||''} ${d}:\n${pathInterpretation(d)}\nHistorical Archetypes: ${(ARCHETYPES[d]||[]).join(', ')}\nMBTI Alignments: ${(MBTI_MAPPINGS[d]||[]).join(', ')}\n`;
      (MBTI_MAPPINGS[d]||[]).forEach(m => {
        msg += `- ${m}: ${MBTI_DESCRIPTIONS[m] || 'No description available'}\n`;
      });
      msg += '\nStrengths: [Expanded strengths based on path]\nWeaknesses: [Expanded weaknesses]\nAdvice: Integrate this path with others for balance.\n';
    });
  }
  msg += '\nOverall Insights: Your choices indicate a blend of paths. Consider how these align with your daily life for personal growth.';
  displayMessage('GAME', msg);
  displayMessage('SYSTEM', 'Game over. Type /restart to play again or /exit to quit.');
}
function pathInterpretation(t){
  let base = '';
  switch(t){
    case 'Action/Ego':
      base = 'You are a force that reshapes reality through will and decisive action, much like Ender breaking the rules in the Giant\'s puzzle. Your strength lies in your ability to take command when others hesitate, to cut through complexity with clarity of purpose. You believe that the world yields to those who act boldly and with conviction.\n\nExpanded: This path reflects a proactive approach to life\'s challenges, often leading to quick resolutions and leadership roles. However, it can lead to burnout if not tempered.\nHowever, beware the shadow of this path: the erosion of empathy, the inability to see nuance, and the temptation to view all obstacles as nails when you have mastered the hammer. True power includes knowing when not to act.';
      break;
    case 'Wisdom/Reason':
      base = 'You navigate by the light of understanding, seeking patterns in chaos and truth in complexity. Your gift is the capacity to observe, analyze, and construct frameworks that bring order to confusion. You trust that knowledge properly wielded is the greatest lever for change.\n\nExpanded: Rational thinkers like you excel in strategic planning and problem-solving, making you invaluable in complex situations. Balance with intuition to avoid over-analysis.\nYet wisdom has its trap: analysis paralysis, the endless deferral of action in pursuit of perfect understanding. Remember that all maps are incomplete, and sometimes the territory demands you move before you fully comprehend it.';
      break;
    case 'Surrender/Flow':
      base = 'You have learned what few master: that there is strength in yielding, power in acceptance, wisdom in recognizing what cannot be controlled. You move with the currents rather than against them, finding the path of least resistance not from weakness but from profound understanding.\n\nExpanded: This path promotes resilience and adaptability, allowing you to thrive in uncertainty. It fosters peace but requires discernment to avoid complacency.\nThe danger lies in mistaking surrender for passivity, in using "flow" as an excuse for abdication. True surrender is active, conscious, and requires as much courage as the fiercest battle. Do not confuse peace with avoidance.';
      break;
    case 'Nero':
      base = 'You walk the path of present-centered wisdom, where compassion and awareness become your primary instruments. Like Ram Dass or Alan Watts, you understand that being fully present‚Äîwithout judgment, without the tyranny of ego‚Äîis itself a revolutionary act.\n\nExpanded: Presence-oriented individuals build deep connections and find inner peace. This path enhances emotional intelligence but watch for detachment from practical matters.\nYour strength is your capacity to hold space for others, to see clearly without the distortions of desire and fear. But beware the subtle pride of the "enlightened," the danger of using spiritual detachment as a shield against genuine engagement with suffering‚Äîboth yours and others.';
      break;
    case 'Nora':
      base = 'You are driven by the sacred flame of inquiry, the relentless need to understand how things work, to peel back layers of mystery until truth stands revealed. Like Marie Curie facing radioactive elements or Carl Sagan contemplating the cosmos, you believe that understanding is humanity\'s highest calling.\n\nExpanded: Inquisitive minds drive innovation and discovery. Your analytical prowess solves puzzles, but remember to factor in human elements.\nYour challenge is remembering that not all truth can be quantified, that some knowledge carries terrible weight, and that the human cost of discovery must never be forgotten. The scientist who loses empathy becomes a technician of death.';
      break;
    case 'Loktal':
      base = 'You are trajectory incarnate‚Äîforce and vision combined, the ability to see what must be and the will to make it so regardless of cost. Like Genghis Khan reshaping continents or Caesar crossing the Rubicon, you understand that history belongs to those who refuse to be constrained by the possible.\n\nExpanded: Visionary leaders reshape worlds, inspiring change on grand scales. Balance ambition with ethics to avoid tyranny.\nBut power without wisdom becomes tyranny, and vision without compassion becomes nightmare. The greatest danger is forgetting that your grand designs are built on a foundation of living beings, each with their own irreplaceable interiority. Do not become the monster you sought to defeat.';
      break;
    case 'Sam':
      base = 'Curiosity is your north star‚Äîthe burning need to know, to explore, to question everything. Like Feynman dismantling a problem with childlike wonder, you refuse to accept "that\'s just how it is" as an answer. Every closed door is an invitation.\n\nExpanded: Curious explorers uncover hidden truths and innovate. Channel your energy to avoid scattering focus.\nThe risk is diffusion: curiosity without discipline becomes dilettantism. Master the art of choosing which questions matter most, which mysteries deserve your finite attention. Not all doors should be opened, and not all knowledge serves wisdom.';
      break;
    case 'Exuro':
      base = 'You are the catalyst, the flame that transforms everything it touches. Like Churchill rallying a nation or Malcolm X demanding justice, you understand that some moments require fire‚Äîthat transformation sometimes demands destruction of the old before the new can emerge.\n\nExpanded: Catalysts ignite change and inspire movements. Harness your passion to build, not just destroy.\nFire purifies but also consumes. The revolutionary can become the tyrant, the reformer can become the destroyer. Learn to distinguish between what must burn and what must be preserved, between righteous fury and mere destruction. Flame serves the forge, not the other way around.';
      break;
    case 'Micromegas':
      base = 'You see from a distance that verges on the cosmic. Like Voltaire\'s Micromegas or Sagan\'s pale blue dot, you understand that individual human dramas are insignificant against the vastness of space and time‚Äîand yet somehow, paradoxically, this makes them more precious, not less.\n\nExpanded: Cosmic perspectives provide wisdom and humility. Ground your views to maintain human connections.\nThe danger of the cosmic perspective is a coldness that masquerades as wisdom, a nihilism dressed as enlightenment. Remember: you are not separate from the universe you observe. The observer is part of the observation, and your detachment is itself a choice with consequences.';
      break;
    default:
      base = 'You have walked a balanced path, drawing from multiple wells of wisdom. This multiplicity is both gift and challenge‚Äîit grants you flexibility and perspective, but may also indicate uncertainty about your deepest convictions. Integration is your task: weaving these threads into a coherent whole rather than remaining forever in synthesis.\n\nExpanded: Balanced individuals adapt well to diverse situations. Work on deepening core strengths for greater impact.';
  }
  return base;
}
function resetGame() {
  currentScenarioId = 0;
  choicesMade = [];
  results = {};
  ALL_PATHS.forEach(p => results[p] = 0);
  chatMessages.innerHTML = '';
  startGame();
}
function handleInput() {
  let msg = chatInput.value.trim();
  if (!msg || !gameStarted) return;
  chatInput.value = '';
  const lowerMsg = msg.toLowerCase();
  if (lowerMsg.startsWith('/')) {
    displayMessage(username, msg);
    if (lowerMsg === '/start') {
      if (choicesMade.length === 0) {
        loadScenario(0);
      } else {
        displayMessage('SYSTEM', 'Game already in progress. Use /restart to start over.');
      }
    } else if (lowerMsg === '/restart') {
      resetGame();
    } else if (lowerMsg === '/exit') {
      displayMessage('SYSTEM', 'Thanks for playing! Exiting game.');
      chatInput.disabled = true;
      sendBtn.disabled = true;
      gameStarted = false;
    } else if (lowerMsg === '/help') {
      displayMessage('SYSTEM', 'Commands:\n/start - Begin the game\n/restart - Start over\n/exit - Quit game\nDuring game, type number of choice (e.g., 1).');
    } else {
      displayMessage('SYSTEM', 'Unknown command. Type /help for commands.');
    }
  } else {
    displayMessage(username, msg);
    makeChoice(msg);
  }
}
// Event listeners
sendBtn.addEventListener('click', handleInput);
chatInput.addEventListener('keypress', (e) => {
  if (e.key === 'Enter') {
    handleInput();
  }
});
// Start
chatMessages.innerHTML = '';
startGame();
</script>
