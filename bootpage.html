<html lang="en">
<head>
<meta charset="utf-8">
<title>BUU Boot Sequence</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
/* --- THEME & SHARED STYLES --- */
:root{
--bg:#001a1a; --fg:#00ffff; --accent:#ffcc00; --border:#00cccc; --panel-bg:#002b2b;
--text-gray:#e6f7f7; --muted:#00aaaa; --online:#00ff9d; --yahoo-blue:#1e73be; --yahoo-dark:#0961a6;
}
html,body{margin:0;height:100%;font-family:'Roboto Mono',monospace;background:var(--bg);color:var(--fg);overflow:auto}
body{background:url('https://wallpapercave.com/wp/wp4468245.jpg') center/cover no-repeat}
#crt::before{content:"";position:fixed;inset:0;background:repeating-linear-gradient(0deg,rgba(0,0,0,0.06),rgba(0,0,0,0.06) 2px,transparent 2px,transparent 4px);pointer-events:none;z-index:999}
@keyframes glitch{2%,64%{transform:translate(2px,0) skew(5deg);}4%,60%{transform:translate(-2px,0) skew(-5deg);}62%{transform:translate(0,0) skew(3deg);}}
.small{font-size:11px;color:var(--muted)}

/* --- BOOT SEQUENCE STYLES (ISOLATED) --- */
/* NEW PRE-BOOT OVERLAY STYLES - Styles for the main boot process are extracted */
#prebootOverlay{position:fixed; inset:0; background:linear-gradient(180deg,rgba(0,0,0,0.9),rgba(0,0,0,0.95)); color:var(--fg); z-index:99999; display:flex; align-items:center; justify-content:center; flex-direction:column;}
/* Instead of loading preboot.html in an iframe, we include a placeholder div/text */
#prebootContent{width:90%; max-width:800px; height:80vh; border:4px solid var(--border); background:var(--panel-bg); display:flex; align-items:center; justify-content:center; font-family: 'Press Start 2P', monospace; font-size: 24px; text-align: center;}
#prebootIframe{width:90%; max-width:800px; height:80vh; border:4px solid var(--border); background:var(--panel-bg);} /* kept this style but it's not needed for the iframe */

#bootOverlay{position:fixed;inset:0;background:linear-gradient(180deg,rgba(0,0,0,0.9),rgba(0,0,0,0.95));color:var(--fg);z-index:99998;display:none;align-items:center;justify-content:center;flex-direction:column;font-family:'Roboto Mono',monospace}
#bootPanel{width:92%;max-width:820px;background:var(--panel-bg);border:4px solid var(--border);padding:18px;box-shadow:0 0 30px rgba(0,255,255,0.06)}
#bootLog{line-height:1.6;white-space:pre-wrap;margin-bottom:12px;font-size:13px;color:var(--text-gray)}
#bootPrompt{color:var(--accent);margin-bottom:6px;animation:blink 1s step-end infinite;}
@keyframes blink{50%{opacity:0;}}
#bootInputs{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
#bootInput{background:#001f1f;border:2px solid var(--border);color:var(--fg);padding:8px;width:48%;min-width:160px;font-family:monospace}
#bootChannel{background:#001f1f;border:2px solid var(--border);color:var(--fg);padding:8px;font-family:monospace;width:48%;min-width:160px}
#bootBtn{background:var(--accent);border:2px solid #000;color:#000;padding:8px 14px;cursor:pointer;font-weight:700}
#bootBanner{margin-top:10px;background:rgba(0,0,0,0.35);padding:8px;border-radius:4px;color:var(--fg);font-size:12px}
#bootBroadcast{animation:glitch 3s infinite alternate;}
</style>
</head>
<body>

<div id="prebootOverlay">
    <iframe id="prebootIframe" src="preboot.html"></iframe>
    <div style="margin-top:10px; font-size:12px; color:var(--accent);">
        [PRESS ANY KEY OR CLICK TO PROCEED TO BUU BOOT SEQUENCE]
    </div>
</div>

<div id="bootOverlay">
    <div id="bootPanel">
        <div id="bootLog" class="small"></div>
        <div id="bootPrompt">> ENTER HANDLE & SELECT SERVER</div>
        <div id="bootInputs">
            <input id="bootInput" type="text" maxlength="30" placeholder="//YourHandle (required)" aria-label="Enter your handle">
            <select id="bootChannel" aria-label="Select server">
                <option value="sam">//Sam</option>
                <option value="exuro">//Exuro</option>
                <option value="nero">//Nero</option>
                <option value="nora">//Nora</option>
                <option value="loktal">//Loktal</option>
            </select>
            <button id="bootBtn" aria-label="Enter Network">ENTER NETWORK</button>
        </div>
        <div id="bootStatus" class="small" style="margin-top:8px;color:var(--accent)"></div>
        <div id="bootBanner" class="small">System Broadcast: <span id="bootBroadcast">Timeline stability.. 84%</span></div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const prebootOverlay = document.getElementById('prebootOverlay');
    const bootOverlay = document.getElementById('bootOverlay');
    const bootLog = document.getElementById('bootLog');
    const bootBtn = document.getElementById('bootBtn');
    const bootInput = document.getElementById('bootInput');
    const bootStatus = document.getElementById('bootStatus');
    const bootPrompt = document.getElementById('bootPrompt');
    const bootInputs = document.getElementById('bootInputs');
    
    // Ensure the main boot console is hidden initially
    bootOverlay.style.display = 'none';

    const bootLines = [
        "C:\\> INITIALIZING buu.guru.exe...",
        "C:\\> Loading kernel.............[ONLINE]",
        "C:\\> Checking Ra'Norric link....[GRANTED]",
        "W:\\> Requesting Timelines.......[GRANTED]",
        "C:\\> Satellite Link.............[ONLINE]",
        "Q:\\> Establishing Ansible.......[CONNECTED]",
        "C:\\> Basic Systems are now......[ENABLED]"
    ];

    let lineIdx = 0;

    function typeBootLine() {
        if (lineIdx < bootLines.length) {
            bootLog.textContent += bootLines[lineIdx] + "\n";
            lineIdx++;
            setTimeout(typeBootLine, 240 + Math.random() * 360);
        } else {
            bootPrompt.style.display = 'block';
            bootInputs.style.display = 'flex';
            bootStatus.textContent = "Status: Ready to connect.";
        }
    }

    // Function to transition from preboot to the console boot sequence
    function startBootSequence() {
        // Stop any listener that would trigger this again
        document.removeEventListener('click', transitionHandler);
        document.removeEventListener('keypress', transitionHandler);
        
        // Hide preboot and show the main boot screen
        prebootOverlay.style.display = 'none';
        bootOverlay.style.display = 'flex'; 
        
        // Prepare for typing animation
        bootPrompt.style.display = 'none';
        bootInputs.style.display = 'none';
        bootStatus.textContent = "Status: Booting...";

        lineIdx = 0;
        bootLog.textContent = '';
        typeBootLine();
    }

    // 1. Handle Preboot Click/Keypress to start the sequence
    const transitionHandler = (event) => {
        // Only trigger if a key is pressed or mouse is clicked anywhere on the document
        if (event.type === 'click' || event.type === 'keypress') {
            // We check if the overlay is still visible to prevent running twice
            if (window.getComputedStyle(prebootOverlay).display !== 'none') {
                startBootSequence();
            }
        }
    };

    document.addEventListener('click', transitionHandler);
    document.addEventListener('keypress', transitionHandler);

    // 2. Handle 'ENTER NETWORK' button click (The redirect to the main app)
    bootBtn.onclick = () => {
        const handle = bootInput.value.trim();
        if (handle) {
            bootStatus.textContent = `// ${handle} attempting connection to selected server...`;
            bootBtn.disabled = true;
            
            // Simulated connection delay
            setTimeout(() => {
                bootStatus.textContent = `// ${handle} [CONNECTION ESTABLISHED]. Redirecting to index.html...`;
                
                // *** CRITICAL REDIRECT: Go to the main website page ***
                window.location.href = 'index.html'; 

            }, 2000); 
        } else {
            bootStatus.textContent = "ERROR: HANDLE IS REQUIRED.";
        }
    };
});
</script>

</body>
</html>
