<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Before Us Universe</title>
<style>
  /* --- Global --- */
  body { margin:0; font-family:'Courier New', monospace; background:#0b0b0b; color:#eee; }
  .container { max-width:900px; margin:auto; padding:2rem; }
  h1 { text-align:center; font-size:2.5rem; margin-bottom:1rem; }
  .status { text-align:center; font-size:1.2rem; margin-bottom:2rem; }

  /* --- Boot/Loading Screen --- */
  #bootScreen { position:fixed; inset:0; background:#000; color:#0ff; display:flex; flex-direction:column; justify-content:center; align-items:center; font-size:1.5rem; z-index:10; }
  #bootScreen.hidden { display:none; }

  /* --- Handle Prompt --- */
  #handlePrompt { display:flex; flex-direction:column; align-items:center; margin-top:2rem; }
  #handlePrompt input { padding:0.5rem; width:200px; margin-top:0.5rem; }

  /* --- Stream Toggle --- */
  .stream-toggle { display:flex; justify-content:center; margin-bottom:1rem; }
  .stream-toggle button { background:#111; color:#eee; border:1px solid #555; margin:0 0.5rem; padding:0.5rem 1rem; cursor:pointer; }
  .stream-toggle button.active { background:#222; border-color:#0ff; color:#0ff; }

  /* --- Streams --- */
  .stream { display:none; background:#111; padding:1rem; border:1px solid #333; border-radius:5px; min-height:300px; overflow-y:auto; margin-bottom:1rem; }
  .stream.active { display:block; }
  .exuro { color:#aaf; }
  .sam { color:#fa8; }

  /* --- Glitch effect for Exuro --- */
  .glitch { position: relative; display:inline-block; }
  .glitch::before, .glitch::after { content: attr(data-text); position:absolute; left:0; top:0; opacity:0.7; color:#0ff; }
  .glitch::before { left:2px; text-shadow:-1px 0 #0ff; animation: glitch-anim 2s infinite; }
  .glitch::after { left:-2px; text-shadow:1px 0 #0ff; animation: glitch-anim2 3s infinite; }
  @keyframes glitch-anim { 0%,20%,40%,60%,80%,100%{transform:translate(0);} 10%,30%,50%,70%,90%{transform:translate(-2px,1px);} }
  @keyframes glitch-anim2 { 0%,20%,40%,60%,80%,100%{transform:translate(0);} 10%,30%,50%,70%,90%{transform:translate(2px,-1px);} }

  /* --- Input Area --- */
  .input-area { display:flex; margin-top:1rem; }
  .input-area input { flex:1; padding:0.5rem; background:#111; border:1px solid #555; color:#eee; font-family:monospace; }
  .input-area button { padding:0.5rem 1rem; background:#0ff; border:none; cursor:pointer; font-weight:bold; color:#000; }

  /* --- Active Users List --- */
  #activeUsers { margin-bottom:1rem; background:#111; border:1px solid #333; padding:0.5rem; border-radius:5px; }
  #activeUsers p { margin:0.2rem 0; }
</style>
</head>
<body>

<!-- Boot Screen -->
<div id="bootScreen">SYSTEM BOOTING...<br><small>Loading...</small></div>

<div class="container" id="mainContent" style="display:none;">

<h1>Before Us Universe</h1>
<div class="status">CURRENT STATUS: <span id="status">007</span></div>

<!-- Active Users -->
<div id="activeUsers"><strong>Active Users:</strong></div>

<!-- Stream Toggle -->
<div class="stream-toggle">
  <button id="btnExuro" class="active">EXURO</button>
  <button id="btnSam">SAM</button>
</div>

<!-- Streams -->
<div id="exuroStream" class="stream active exuro"></div>
<div id="samStream" class="stream sam"></div>

<!-- Input -->
<div class="input-area">
  <input type="text" id="userInput" placeholder="Type message...">
  <button id="sendBtn">POST</button>
</div>

</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  // --- Replace with your Firebase config ---
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // --- Boot sequence ---
  setTimeout(() => {
    document.getElementById('bootScreen').classList.add('hidden');
    document.getElementById('mainContent').style.display = 'block';
    askHandle();
  }, 3000);

  let userHandle = '';
  function askHandle() {
    userHandle = prompt("Enter your handle:");
    if(!userHandle) userHandle = "Anonymous_" + Math.floor(Math.random()*1000);
    setUserActive(userHandle);
  }

  // --- Active Users Tracking ---
  const activeUsersRef = db.ref('activeUsers');
  function setUserActive(handle) {
    const userRef = activeUsersRef.child(handle);
    userRef.set(true);
    userRef.onDisconnect().remove();
  }

  activeUsersRef.on('value', snapshot => {
    const usersDiv = document.getElementById('activeUsers');
    usersDiv.innerHTML = "<strong>Active Users:</strong>";
    snapshot.forEach(child => {
      const p = document.createElement('p');
      p.textContent = child.key;
      usersDiv.appendChild(p);
    });
  });

  // --- Stream Toggle ---
  const btnExuro = document.getElementById('btnExuro');
  const btnSam = document.getElementById('btnSam');
  const exuroStream = document.getElementById('exuroStream');
  const samStream = document.getElementById('samStream');

  btnExuro.addEventListener('click', () => {
    exuroStream.classList.add('active');
    samStream.classList.remove('active');
    btnExuro.classList.add('active');
    btnSam.classList.remove('active');
  });
  btnSam.addEventListener('click', () => {
    samStream.classList.add('active');
    exuroStream.classList.remove('active');
    btnSam.classList.add('active');
    btnExuro.classList.remove('active');
  });

  // --- Status Counter ---
  const statusEl = document.getElementById('status');
  setInterval(() => { statusEl.textContent = String(Math.floor(Math.random()*999+1)).padStart(3,'0'); }, 10000);

  // --- Chat Messaging ---
  const input = document.getElementById('userInput');
  const sendBtn = document.getElementById('sendBtn');

  const messagesRef = db.ref('messages');

  sendBtn.addEventListener('click', postMessage);
  input.addEventListener('keypress', (e)=>{ if(e.key==='Enter') postMessage(); });

  function postMessage(){
    const text = input.value.trim();
    if(!text) return;
    const activeStream = exuroStream.classList.contains('active') ? 'exuro' : 'sam';
    messagesRef.push({
      handle: userHandle,
      text: text,
      stream: activeStream,
      timestamp: Date.now()
    });
    input.value = '';
  }

  // --- Listen for new messages ---
  messagesRef.on('child_added', snapshot=>{
    const data = snapshot.val();
    const p = document.createElement('p');
    if(data.stream==='exuro'){
      p.className='exuro glitch';
      p.setAttribute('data-text', `[EXURO][${data.handle}]: ${data.text}`);
      p.textContent = `[EXURO][${data.handle}]: ${data.text}`;
      exuroStream.appendChild(p);
      exuroStream.scrollTop = exuroStream.scrollHeight;
    } else {
      p.className='sam';
      p.textContent = `[SAM][${data.handle}]: ${data.text}`;
      samStream.appendChild(p);
      samStream.scrollTop = samStream.scrollHeight;
    }
  });

</script>

</body>
</html>

  </script>
</body>
</html>
